# Plan implementacji widoku: Pusty Stan

## 1. PrzeglƒÖd

Widok pustego stanu to pierwsza interakcja zalogowanego u≈ºytkownika z aplikacjƒÖ MyFreezer, gdy nie posiada jeszcze ≈ºadnych kontener√≥w. Jego celem jest onboarding nowych u≈ºytkownik√≥w przez prezentacjƒô funkcjonalno≈õci i umo≈ºliwienie ≈Çatwego utworzenia pierwszego kontenera.

## 2. Routing widoku

**≈öcie≈ºka**: `/` (stan uwierzytelniony bez kontener√≥w)
**Warunki dostƒôpu**: 
- U≈ºytkownik zalogowany (aktywna sesja)
- Brak kontener√≥w w bazie danych

**Przekierowania po akcjach**:
- Po utworzeniu pierwszego kontenera ‚Üí Main Dashboard View
- Przy b≈Çƒôdach auth ‚Üí Login/Landing View

## 3. Struktura komponent√≥w

```
EmptyStateView
‚îú‚îÄ‚îÄ Header
‚îÇ   ‚îú‚îÄ‚îÄ AppTitle  
‚îÇ   ‚îî‚îÄ‚îÄ UserProfile
‚îú‚îÄ‚îÄ EmptyStateContent
‚îÇ   ‚îú‚îÄ‚îÄ WelcomeSection
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ WelcomeHeading
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AppDescription
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ FeaturesList
‚îÇ   ‚îú‚îÄ‚îÄ CallToAction
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ PrimaryButton ("Dodaj pierwszƒÖ zamra≈ºarkƒô")
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ SecondaryHint (info o komendach g≈Çosowych)
‚îÇ   ‚îî‚îÄ‚îÄ IllustrationOrIcon
‚îî‚îÄ‚îÄ CreateContainerModal
    ‚îú‚îÄ‚îÄ ModalHeader
    ‚îú‚îÄ‚îÄ ContainerForm
    ‚îÇ   ‚îú‚îÄ‚îÄ NameInput
    ‚îÇ   ‚îú‚îÄ‚îÄ TypeSelector (Zamra≈ºarka/Lod√≥wka)
    ‚îÇ   ‚îî‚îÄ‚îÄ FormActions
    ‚îî‚îÄ‚îÄ LoadingState
```

## 4. Szczeg√≥≈Çy komponent√≥w

### EmptyStateView (g≈Ç√≥wny kontener)

- **Opis komponentu**: G≈Ç√≥wny kontener widoku pustego stanu, zarzƒÖdza stanem tworzenia pierwszego kontenera
- **G≈Ç√≥wne elementy**: Header, centralna sekcja z welcome message, modal do tworzenia kontenera
- **Komponenty podrzƒôdne**: Header, EmptyStateContent, CreateContainerModal
- **Obs≈Çugiwane interakcje**:
  - Sprawdzenie czy u≈ºytkownik ma kontenery przy montowaniu
  - Obs≈Çuga otwarcia modala tworzenia kontenera
  - Przekierowanie do dashboard po utworzeniu kontenera
  - ZarzƒÖdzanie stanem loading i b≈Çƒôd√≥w
- **Walidacja**:
  - Weryfikacja stanu uwierzytelnienia
  - Sprawdzenie czy rzeczywi≈õcie brak kontener√≥w
  - Weryfikacja uprawnie≈Ñ do tworzenia kontener√≥w
- **Typy**: `ContainerListResponseDTO`, `CreateContainerCommandDTO`, stan modala
- **Props**: Brak (g≈Ç√≥wny komponent strony)

### Header

- **Opis komponentu**: Uproszczony header bez wyszukiwania, z logo i profilem u≈ºytkownika
- **G≈Ç√≥wne elementy**: Logo/nazwa aplikacji, avatar u≈ºytkownika z podstawowym menu
- **Komponenty podrzƒôdne**: UserProfile (opcjonalnie)
- **Obs≈Çugiwane interakcje**:
  - Menu u≈ºytkownika (wylogowanie)
  - Branding aplikacji
- **Walidacja**: Brak
- **Typy**: User session info
- **Props**: 
  - `userName?: string`
  - `onLogout?: () => void`

### EmptyStateContent

- **Opis komponentu**: G≈Ç√≥wna sekcja z welcome message i call-to-action
- **G≈Ç√≥wne elementy**: Welcome heading, opis aplikacji, lista funkcjonalno≈õci, g≈Ç√≥wny przycisk akcji
- **Komponenty podrzƒôdne**: WelcomeSection, CallToAction, IllustrationOrIcon
- **Obs≈Çugiwane interakcje**:
  - Klikniƒôcie g≈Ç√≥wnego CTA ‚Üí otwarcie modala
  - Prezentacja informacji o aplikacji
- **Walidacja**: Brak
- **Typy**: Event handlers dla otwierania modala
- **Props**:
  - `onCreateFirstContainer: () => void`

### WelcomeSection

- **Opis komponentu**: Sekcja powitalna z opisem aplikacji i jej mo≈ºliwo≈õci
- **G≈Ç√≥wne elementy**: 
  - Nag≈Ç√≥wek "Witaj w MyFreezer!"
  - Opis "ZarzƒÖdzaj zawarto≈õciƒÖ lod√≥wki i zamra≈ºarki g≈Çosowo"
  - Lista g≈Ç√≥wnych funkcjonalno≈õci
- **Komponenty podrzƒôdne**: FeaturesList
- **Obs≈Çugiwane interakcje**: Prezentacja informacji
- **Walidacja**: Brak
- **Typy**: Brak specjalnych typ√≥w
- **Props**: Brak

### FeaturesList

- **Opis komponentu**: Lista g≈Ç√≥wnych funkcjonalno≈õci aplikacji dla nowych u≈ºytkownik√≥w
- **G≈Ç√≥wne elementy**: 
  - Ikony z opisami funkcjonalno≈õci:
    - üé§ "Dodawaj produkty g≈Çosowo"
    - üîç "Sprawdzaj zawarto≈õƒá jednƒÖ komendƒÖ"
    - üì± "ZarzƒÖdzaj przez interfejs"
    - üóÇÔ∏è "Organizuj w p√≥≈Çki i kontenery"
- **Obs≈Çugiwane interakcje**: Statyczna prezentacja
- **Walidacja**: Brak
- **Typy**: Lista feature items
- **Props**: Brak

### CallToAction

- **Opis komponentu**: Sekcja z g≈Ç√≥wnym call-to-action i wskaz√≥wkami
- **G≈Ç√≥wne elementy**: 
  - G≈Ç√≥wny przycisk "Dodaj pierwszƒÖ zamra≈ºarkƒô"
  - Dodatkowa informacja o komendach g≈Çosowych
  - Hint "Po utworzeniu kontenera bƒôdziesz m√≥g≈Ç u≈ºywaƒá komend g≈Çosowych"
- **Obs≈Çugiwane interakcje**:
  - Klikniƒôcie przycisku ‚Üí otwarcie modala
- **Walidacja**: Brak
- **Typy**: Event handlers
- **Props**:
  - `onPrimaryAction: () => void`
  - `isLoading?: boolean`

### CreateContainerModal

- **Opis komponentu**: Modal do tworzenia pierwszego kontenera z formularzem
- **G≈Ç√≥wne elementy**: Header modala, formularz z polami, przyciski akcji, loading state
- **Komponenty podrzƒôdne**: ContainerForm
- **Obs≈Çugiwane interakcje**:
  - Wype≈Çnienie formularza (nazwa, typ)
  - Walidacja danych
  - Wys≈Çanie ≈ºƒÖdania POST /api/containers
  - Zamkniƒôcie modala
  - Obs≈Çuga b≈Çƒôd√≥w
- **Walidacja**:
  - Nazwa kontenera (niepusta, max 255 znak√≥w)
  - Typ kontenera (zamra≈ºarka/lod√≥wka)
  - Sprawdzenie czy formularz jest kompletny
- **Typy**: `CreateContainerCommandDTO`, `ContainerDTO`, formularz state
- **Props**:
  - `isOpen: boolean`
  - `onClose: () => void`
  - `onSuccess: (container: ContainerDTO) => void`
  - `onError: (error: string) => void`

### ContainerForm

- **Opis komponentu**: Formularz w modalu do wprowadzenia danych kontenera
- **G≈Ç√≥wne elementy**: 
  - Input dla nazwy kontenera
  - Radio/Select dla typu (zamra≈ºarka/lod√≥wka)
  - Przyciski "Anuluj" i "Utw√≥rz"
  - Komunikaty walidacji
- **Obs≈Çugiwane interakcje**:
  - Wpisywanie nazwy z walidacjƒÖ
  - Wyb√≥r typu kontenera
  - Submit formularza
  - Reset formularza przy anulowaniu
- **Walidacja**:
  - Nazwa: required, minLength: 1, maxLength: 255
  - Typ: required, one of ['freezer', 'fridge']
  - Real-time walidacja z komunikatami b≈Çƒôd√≥w
- **Typy**: `CreateContainerCommandDTO`, form validation state
- **Props**:
  - `onSubmit: (data: CreateContainerCommandDTO) => void`
  - `onCancel: () => void`
  - `isSubmitting: boolean`
  - `error?: string`

## 5. Typy

### Nowe typy widokowe

```typescript
interface EmptyStateViewState {
  isModalOpen: boolean;
  isCreatingContainer: boolean;
  createError: string | null;
  hasCheckedContainers: boolean;
}

interface CreateContainerFormData {
  name: string;
  type: 'freezer' | 'fridge';
}

interface CreateContainerFormState {
  data: CreateContainerFormData;
  errors: Partial<Record<keyof CreateContainerFormData, string>>;
  touched: Partial<Record<keyof CreateContainerFormData, boolean>>;
  isValid: boolean;
  isSubmitting: boolean;
}

interface FeatureItem {
  icon: string;
  title: string;
  description: string;
}

interface CreateContainerModalProps {
  isOpen: boolean;
  onClose: () => void;
  onSuccess: (container: ContainerDTO) => void;
  onError: (error: string) => void;
}
```

### Wykorzystywane typy z types.ts

- `CreateContainerCommandDTO` - dane do utworzenia kontenera
- `ContainerDTO` - odpowied≈∫ po utworzeniu kontenera
- `ContainerListResponseDTO` - sprawdzenie czy sƒÖ kontenery
- `ContainerType` - typ kontenera (freezer/fridge)
- `HealthCheckResponseDTO` - weryfikacja sesji

## 6. ZarzƒÖdzanie stanem

### Stan lokalny g≈Ç√≥wnego komponentu

```typescript
const useEmptyState = () => {
  const [state, setState] = useState<EmptyStateViewState>({
    isModalOpen: false,
    isCreatingContainer: false,
    createError: null,
    hasCheckedContainers: false
  });
  
  const openModal = () => setState(prev => ({ ...prev, isModalOpen: true }));
  const closeModal = () => setState(prev => ({ ...prev, isModalOpen: false, createError: null }));
  
  const createContainer = async (data: CreateContainerCommandDTO) => {
    // implementacja tworzenia kontenera
  };
  
  return { state, openModal, closeModal, createContainer };
}
```

### Stan formularza w modalu

```typescript
const useCreateContainerForm = () => {
  const [formState, setFormState] = useState<CreateContainerFormState>({
    data: { name: '', type: 'freezer' },
    errors: {},
    touched: {},
    isValid: false,
    isSubmitting: false
  });
  
  const validateField = (field: keyof CreateContainerFormData, value: string) => {
    // walidacja poszczeg√≥lnych p√≥l
  };
  
  const handleSubmit = async (onSubmit: (data: CreateContainerCommandDTO) => void) => {
    // obs≈Çuga wys≈Çania formularza
  };
  
  return { formState, validateField, handleSubmit, resetForm };
}
```

### Custom hooks

- `useContainerCheck` - sprawdzenie czy u≈ºytkownik ma kontenery
- `useCreateContainer` - logika tworzenia pierwszego kontenera
- `useRedirectAfterCreate` - przekierowanie po utworzeniu kontenera

## 7. Integracja z API

### Wykorzystywane endpointy

**Sprawdzenie kontener√≥w**
- **Endpoint**: `GET /api/containers`
- **Typ ≈ºƒÖdania**: Brak parametr√≥w
- **Typ odpowiedzi**: `ContainerListResponseDTO`
- **Zastosowanie**: Weryfikacja czy u≈ºytkownik rzeczywi≈õcie nie ma kontener√≥w

**Tworzenie kontenera**
- **Endpoint**: `POST /api/containers`
- **Typ ≈ºƒÖdania**: `CreateContainerCommandDTO`
- **Typ odpowiedzi**: `ContainerDTO`
- **Zastosowanie**: Utworzenie pierwszego kontenera u≈ºytkownika

**Weryfikacja sesji**
- **Endpoint**: `GET /api/health`
- **Typ ≈ºƒÖdania**: Brak parametr√≥w
- **Typ odpowiedzi**: `HealthCheckResponseDTO`
- **Zastosowanie**: Sprawdzenie czy u≈ºytkownik jest nadal zalogowany

## 8. Interakcje u≈ºytkownika

### Pierwsze wej≈õcie do aplikacji

1. U≈ºytkownik loguje siƒô i zostaje przekierowany do `/`
2. System sprawdza kontenery przez `GET /api/containers`
3. Je≈õli brak kontener√≥w ‚Üí wy≈õwietlenie Empty State View
4. Je≈õli sƒÖ kontenery ‚Üí przekierowanie do Main Dashboard

### Utworzenie pierwszego kontenera

1. U≈ºytkownik klika "Dodaj pierwszƒÖ zamra≈ºarkƒô"
2. Otwarcie modala z formularzem
3. Wype≈Çnienie nazwy kontenera (np. "Zamra≈ºarka kuchenna")
4. Wyb√≥r typu (zamra≈ºarka/lod√≥wka)
5. Klikniƒôcie "Utw√≥rz"
6. Walidacja formularza po stronie frontend
7. Wys≈Çanie `POST /api/containers` z danymi
8. Wy≈õwietlenie loading state w modalu
9. Po sukcesie ‚Üí zamkniƒôcie modala + przekierowanie do Dashboard
10. Po b≈Çƒôdzie ‚Üí wy≈õwietlenie komunikatu w modalu

### Anulowanie procesu

1. U≈ºytkownik mo≈ºe zamknƒÖƒá modal przez X lub "Anuluj"
2. Reset formularza do stanu poczƒÖtkowego
3. Powr√≥t do Empty State View

## 9. Warunki i walidacja

### Walidacja dostƒôpu do widoku

- Sprawdzenie aktywnej sesji przez `/api/health`
- Weryfikacja ≈ºe u≈ºytkownik nie ma kontener√≥w
- Przekierowanie je≈õli powy≈ºsze warunki nie sƒÖ spe≈Çnione

### Walidacja formularza kontenera

**Nazwa kontenera**:
- Required: "Nazwa kontenera jest wymagana"
- Minimum length (1): "Nazwa nie mo≈ºe byƒá pusta"
- Maximum length (255): "Nazwa mo≈ºe mieƒá maksymalnie 255 znak√≥w"
- Trim whitespace przed walidacjƒÖ

**Typ kontenera**:
- Required: "Wybierz typ kontenera"
- Enum validation: musi byƒá 'freezer' lub 'fridge'

### Walidacja biznesowa

- Sprawdzenie czy u≈ºytkownik mo≈ºe tworzyƒá kontenery (limity)
- Weryfikacja uprawnie≈Ñ w bazie danych
- Sprawdzenie unikalno≈õci nazwy (opcjonalnie)

## 10. Obs≈Çuga b≈Çƒôd√≥w

### B≈Çƒôdy sprawdzania kontener√≥w

- **401 Unauthorized**: Przekierowanie do logowania
- **500 Server Error**: Toast "B≈ÇƒÖd ≈Çadowania danych, spr√≥buj ponownie"
- **Network Error**: Toast "Sprawd≈∫ po≈ÇƒÖczenie internetowe"

### B≈Çƒôdy tworzenia kontenera

- **400 Bad Request**: Wy≈õwietlenie komunikatu walidacji w modalu
- **401 Unauthorized**: Przekierowanie do logowania  
- **500 Server Error**: Toast "B≈ÇƒÖd tworzenia kontenera"
- **Network Timeout**: Toast "Przekroczono czas oczekiwania"

### B≈Çƒôdy walidacji formularza

- **Pusta nazwa**: "Nazwa kontenera jest wymagana" pod polem
- **Za d≈Çuga nazwa**: "Nazwa mo≈ºe mieƒá maksymalnie 255 znak√≥w"
- **Brak typu**: "Wybierz typ kontenera" pod selekcjƒÖ

### Scenariusze fallback

- **B≈ÇƒÖd ≈Çadowania**: Przycisk "Spr√≥buj ponownie" zamiast g≈Ç√≥wnego CTA
- **B≈Çƒôdy API**: Mo≈ºliwo≈õƒá retry dla operacji
- **B≈Çƒôdy sesji**: Automatyczne przekierowanie do logowania

## 11. Kroki implementacji

1. **Podstawowa struktura widoku**
   - Utworzenie logiki routingu w `src/pages/index.astro`
   - Dodanie warunk√≥w sprawdzania kontener√≥w
   - Implementacja podstawowego layoutu Empty State

2. **Komponenty prezentacyjne**
   - `EmptyStateContent.tsx` z welcome message
   - `FeaturesList.tsx` z listƒÖ funkcjonalno≈õci
   - Responsive design zgodny z Tailwind + Shadcn/ui

3. **Modal i formularz**
   - `CreateContainerModal.tsx` z podstawowƒÖ strukturƒÖ
   - `ContainerForm.tsx` z polami nazwa/typ
   - Implementacja walidacji formularza

4. **Integracja z API**
   - Custom hook `useCreateContainer`
   - Obs≈Çuga `POST /api/containers`
   - ZarzƒÖdzanie stanem loading/error

5. **Sprawdzanie kontener√≥w**
   - Logic sprawdzania czy u≈ºytkownik ma kontenery
   - Integration z `GET /api/containers`
   - Przekierowania miƒôdzy widokami

6. **System b≈Çƒôd√≥w i UX**
   - Toast notifications dla b≈Çƒôd√≥w
   - Loading states w modalu i przyciskach
   - Graceful error handling

7. **Walidacja i edge cases**
   - Frontend validation dla formularza
   - Obs≈Çuga scenariuszy b≈Çƒôd√≥w
   - Testowanie edge cases

8. **Finalizacja i optymalizacja**
   - Responsive design testing
   - Accessibility improvements
   - Performance optimizations
   - Animations i micro-interactions 